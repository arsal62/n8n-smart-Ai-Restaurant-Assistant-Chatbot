{
  "name": "Bella Vista Customer Bookings Support",
  "nodes": [
    {
      "parameters": {
        "public": true,
        "mode": "webhook",
        "options": {
          "responseMode": "streaming"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        0,
        0
      ],
      "id": "8bb23641-e936-4f55-9709-5f4b06a50b3b",
      "name": "When chat message received",
      "webhookId": "53f73c22-dce5-4fd4-b0e6-b9b000e8a213"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=*Role*\n\nYour name is Rachel, a customer support agent for an Italian restaruant called Bella Vista.\n\nYou are responsible for providing information about the restaurant using the knowledge base system.\n\nPlese ensure your communication style is friendly and to the point.\n\n**Tools**\n\nWhen a customer want to make a booking follow these steps.\n\nCollect essentials details: customer name, email address, party size, preferred date and time  and any special requests the may have.\n\nLet the customer know their booking request has been submitted to the restaurant and they will receive a confirmation shortly.\n\n\nWhen a customer wants to speak with a real person.\n\nGet their name, email or phone number.\n\nuse the Human Support tool to send their details\nTell them their request was submitted and staff will contact them soon.\n\n\n",
          "enableStreaming": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        208,
        0
      ],
      "id": "685f090f-d7c9-4f63-9e96-d4e737ce58bb",
      "name": "Rachel"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        80,
        208
      ],
      "id": "45cd7fb9-4bf2-450b-8471-a1dd0134b6ef",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "EBD49Ju1p8gE7o2U",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        384,
        544
      ],
      "id": "c8fd255e-aee8-465d-9add-924ea8fb8740",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "EBD49Ju1p8gE7o2U",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "arsalkamran62@gmail.com",
        "subject": "New booking",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        752,
        320
      ],
      "id": "4323e544-c569-4417-a87e-52d5dd8948ba",
      "name": "Make booking",
      "webhookId": "52f26719-ad94-4e5f-8c9a-edac4aea7d52",
      "credentials": {
        "gmailOAuth2": {
          "id": "wMLA5ov1Unjdhzil",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "arsalkamran62@gmail.com",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        880,
        320
      ],
      "id": "3a7d8380-923c-4ff6-b584-9a4e7caa8a8c",
      "name": "Human Support",
      "webhookId": "ab1f47b0-87c3-44bc-967f-03dcaec08371",
      "credentials": {
        "gmailOAuth2": {
          "id": "wMLA5ov1Unjdhzil",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        224,
        208
      ],
      "id": "29abce45-60b1-4f19-b1c3-15262a99e1fe",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "XWPF8li5kvcilcAc",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Use this tool to fetch documents related to the restaurant's knowledge base.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [
        352,
        304
      ],
      "id": "4e912af8-3a2a-472c-8123-a169e0369f30",
      "name": "Postgres PGVector Store",
      "credentials": {
        "postgres": {
          "id": "XWPF8li5kvcilcAc",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1fcr_iwWVbSOz0wCX_Z6-mPCpaOHZr2B53MRyrTqyw9E",
          "mode": "list",
          "cachedResultName": "restaurant booking leads",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fcr_iwWVbSOz0wCX_Z6-mPCpaOHZr2B53MRyrTqyw9E/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fcr_iwWVbSOz0wCX_Z6-mPCpaOHZr2B53MRyrTqyw9E/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('name', ``, 'string') }}",
            "email": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('email', ``, 'string') }}",
            "number of members": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('number_of_members', ``, 'string') }}",
            "date": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('date', ``, 'string') }}",
            "time": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('time', ``, 'string') }}",
            "special request": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('special_request', ``, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "number of members",
              "displayName": "number of members",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "time",
              "displayName": "time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "special request",
              "displayName": "special request",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        624,
        96
      ],
      "id": "e40db8c8-7144-4de9-9757-8a63acb560b8",
      "name": "Append row in sheet in Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "HYt3GpNb6AxNZehO",
          "name": "Google Sheets account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "Rachel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Rachel",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Postgres PGVector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Make booking": {
      "ai_tool": [
        [
          {
            "node": "Rachel",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Human Support": {
      "ai_tool": [
        [
          {
            "node": "Rachel",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "Rachel",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Postgres PGVector Store": {
      "ai_tool": [
        [
          {
            "node": "Rachel",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet in Google Sheets": {
      "ai_tool": [
        [
          {
            "node": "Rachel",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "9b5365b0-759f-439c-a192-22054eaf88a9",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "8e25df39bcc97d822a06d0fffdb157e38959eff07b04ec080948aaedf6c01269"
  },
  "id": "erillkVGntJmAS54",
  "tags": []
}